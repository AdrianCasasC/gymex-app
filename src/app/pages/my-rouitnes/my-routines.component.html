<section class="routine-top">
  <h1>Mis rutinas</h1>
  <div (click)="showNewRoutineModal = true" class="routine-top-add primary-box">
    <span>{{ "routine.add" | transloco }}</span>
    <mat-icon>add_circle_outline</mat-icon>
  </div>
</section>

<div class="routines-content flex-col-cent">
  <ng-container *ngIf="myRoutines && myRoutines.length > 0; else noRoutines">
    <section class="my-routines-wrapper">
      <span
        class="primary-box selected-box routine"
        *ngFor="let routine of myRoutines"
        (click)="selectedRoutine = routine"
        (longPress)="routine.showProperties = true"
        [ngClass]="{ 'selected-box': selectedRoutine === routine }"
        >{{ routine.name }}
        <app-properties-popup
          class="modal"
          *ngIf="routine.showProperties"
          [position]="'top'"
          (clickOutsideContent)="routine.showProperties = false"
          (selectedOption)="popupSelectedOption($event, routine)"
        ></app-properties-popup>
      </span>
    </section>

    <section class="routines-exercise-wrapper">
      <img
        [src]="'../../../assets/images/random/image_' + randomImage1 + '.jpg'"
      />
      <img
        [src]="'../../../assets/images/random/image_' + randomImage2 + '.jpg'"
      />
      <div
        *ngFor="let exercise of selectedRoutine?.exercises; let i = index"
        class="register-exercises"
      >
        <div class="title-edit">
          <h2>
            {{ "exercises." + exercise.name | transloco }}
          </h2>
          <mat-icon (click)="editExerciseSeries(exercise)">edit</mat-icon>
        </div>
        <span
          >{{ exercise.series.length }}
          {{ exercise.series.length === 1 ? "serie" : "series" }}</span
        >
      </div>
    </section>
  </ng-container>

  <p-progressSpinner
    *ngIf="spinnerService.spinnerState$ | async"
    styleClass="w-4rem h-4rem"
    strokeWidth="2"
    animationDuration="1s"
  ></p-progressSpinner>
</div>

<ng-template #noRoutines>
  <section
    *ngIf="(spinnerService.spinnerState$ | async) === false"
    class="noRoutines flex-col-cent"
  >
    <h2>{{ "routine.noRoutines" | transloco }}</h2>
    <img [src]="exerciseImagesLinks.noRoutines" />
  </section>
</ng-template>

<app-series-modal
  *ngIf="showEditSeriesModal"
  class="modal"
  [selectedExercise]="exerciseToEdit.name"
  [error]="saveSuccessfully === 'KO'"
  (applySavedSeries)="saveSeries($event)"
  (closeModal)="showEditSeriesModal = false"
></app-series-modal>

<app-input-modal
  *ngIf="showChangeRoutineNameModal"
  (closeModal)="showChangeRoutineNameModal = false"
  (writtenText)="changeRoutineName($event)"
  [labelText]="'Nuevo nombre de la rutina'"
  class="modal"
></app-input-modal>

<app-input-modal
  *ngIf="showNewRoutineModal"
  (closeModal)="showNewRoutineModal = false"
  (writtenText)="addNewRoutine($event)"
  [labelText]="'modal.label' | transloco"
  class="modal"
></app-input-modal>

<app-save-modal
  *ngIf="saveSuccessfully === 'OK'"
  class="modal"
  [label]="'Â¡Rutina Guardada!'"
  [successfullSave]="saveSuccessfully === 'OK'"
>
</app-save-modal>
